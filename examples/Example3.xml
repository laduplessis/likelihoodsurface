<!--

    Modify specific dimensions of multidimensional parameters (skylines). 
    In this case R0 and sampling proportion both have a shift and we compare the first R0 to sampling proportion.

    (Remember indices start at 0, not at 1...)

-->

<beast namespace="beast.core:beast.evolution.likelihood:beast.core.parameter:beast.util:beast.evolution.speciation:beast.core.util:likelihoodsurface" version="2.0">

    <tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick='((1:0.665867995915101,((2:0.4664991938058005,(3:0.3556227921617192,((((((((4:0.28218320917373063,(5:0.5090456784513178,6:0.4207695156008393):0.10633653199469162):0.8262299441731189,(((7:0.9338948596763217,(8:0.19442260828658142,9:1.0906512973553806):0.027678481371134822):1.0546923273083753,10:0.5505925453817984):0.6866758309456618,11:2.123219078182542):1.5400339793874442):0.7042598583909445,(12:1.4100000357332494,((13:0.756475098060923,((((14:2.101163765545417,(15:0.45442250061496736,16:1.6688618691885946):0.22795126501147678):0.009767504815329175,17:1.1618648220396093):0.5908393719835541,18:2.6059944117517695):0.17919976062028908,(19:1.7879834607299987,20:0.7549733788916946):0.9502163167144531):0.4314870384045193):1.079668301316552,(21:4.2665466932529785,22:0.16651131828134602):0.4650794030563663):1.2745771309185336):2.703087971692729):0.0345358976137522,((23:0.16015244178119836,((24:1.752610216977681,25:0.14613267577972167):0.9952093257179264,26:5.09334314415416):2.1219439209954425):1.4510226882281474,27:0.1664651695520254):0.16959394892431856):0.7365483628784224,((((28:1.4525248458736382,29:5.634051625692921):0.7422792932371154,30:3.5858926857931666):0.051358663390305814,(31:0.23524170907997988,32:0.33434710836042214):0.1577871522592229):0.09691012894743434,((((33:0.999402680827858,34:0.5740818082080672):1.6005529784540418,35:2.1849176712878045):0.30408118598686507,36:1.5097122553323832):0.0846712466195676,(37:0.8234044263441014,38:0.0484997278971111):0.008232878343306993):3.7293306114722506):1.582993326849512):0.7665369224842742,((39:1.9013707389783665,(40:4.692061743989797,(41:0.32080751271549524,42:0.4152620135028062):0.6796362002153398):0.2665399468075371):2.958242150343457,((43:1.293062481303977,44:7.0396786584810584):0.8123378988346808,45:0.6562506839803488):0.7666710858895947):0.8974957139687785):0.30358327749128655,46:1.1345335107804546):1.8378792131864632,(((((((((47:0.2970607308379698,(48:2.0870538831055274,(49:0.7435738918797412,50:0.8309187974560661):0.9769206022995185):0.09185120558774607):3.4093255278780745,51:1.521631412491459):1.1838913882423245,52:2.1336838641552553):0.7404604873161178,53:0.19332841801135547):0.4146114419411422,54:0.7855659770421521):0.24485485264707663,((55:1.604576026702567,(56:0.028352994310250068,57:1.0281324174737616):2.505077016772285):1.1672097010213465,58:2.42273775422433):0.7777585994767833):0.42969102255768554,59:0.13800342647627506):2.4850107407707696,(60:1.4644228949820772,((61:1.117667833401054,62:0.6145111140274526):1.9646724587269908,63:0.696982740227309):4.566323278501075):0.30326714754098116):0.786760141674455,64:0.2797219893958358):0.2738656267132926):0.7475536731289378):0.47305140436285154):0.3694826429165514,((((65:0.35366870894391855,(66:0.20734346544752746,67:0.0433132786918069):0.025869257005808777):1.9330695693300464,68:0.7577274701505545):0.5903527827694477,(69:0.3859871938426567,70:0.14710544529994696):3.068393763626261):1.5530195627453411,((71:0.055185336051106315,((72:0.28223235705165006,((73:0.11920089714574456,(74:3.62829575650502,75:0.3098440691795066):0.4597428024478214):2.422273083232585,((76:0.3941151928154598,77:0.1270147943513278):0.06166984514455809,((78:0.5947645135038986,79:3.167711517838047):0.7604164579304484,((80:0.9419645882090126,(81:0.17231160621938812,82:1.7377226921491342):0.14212918305838507):3.498645250932878,(83:0.004235469064841624,84:1.168455557818044):0.6780179057125171):0.14100117882523477):2.011997687528157):0.3448557029526258):0.2946811389284738):0.346924161631768,85:1.6583690965795626):0.914201724461448):2.0143480481154903,((86:0.22823565205221197,((87:1.6885772275397892,(88:4.45305326561578,89:0.6432020598095498):0.846539913005028):0.5939310531634758,90:1.1936229242916347):0.9268897626536456):1.4405875218542907,((((91:0.6375753989424489,(92:0.1997374765307356,((93:0.15121257068514282,94:0.025340501078273903):0.527256058122541,95:1.1697719636729147):1.5337567066864395):0.629743745893542):0.7245745854159518,96:2.3535315171545745):0.5497179664440885,(97:0.19674139820143122,98:1.0451881088893114):0.4145570993002883):3.6485202875228664,99:0.5143701914747432):0.5814646207345753):0.09719849063774832):0.9892086525240089):0.02371657856354714):0.8450589669309634):0.050649061042128324,100:0.265946687343956):0.02584050432186505;
'/>


    <distribution id="prior" spec="util.CompoundDistribution">

        <distribution spec="BirthDeathSkylineModel" id="birthDeath" tree="@tree">
            <parameter name="origin" id="origin" value ="15"/>
            <parameter name="R0" id="R0" value="1" dimension="2"/>
            <parameter name="becomeUninfectiousRate" id="becomeUninfectiousRate" value="0.5" dimension="1"/>
            <parameter name="samplingProportion" id="samplingProportion" value="0.8" dimension="2"/>            
        </distribution>

    </distribution>


    <run spec="LikelihoodSurface" distribution="@prior">

        <state id="state" storeEvery="1000">            
            <stateNode idref='R0'/>
            <!--stateNode idref='becomeUninfectiousRate'/-->
            <stateNode idref='samplingProportion'/>   
            <!--stateNode idref='origin'/-->
        </state>
        
        <gridder spec="Gridder" parameter="@R0" from="0.1" to="5" by="0.25" index="0"/>
        <!--gridder spec="Gridder" parameter="@becomeUninfectiousRate" from="0.1" to="5" by="0.25"/-->
        <gridder spec="likelihoodsurface.Gridder" parameter="@samplingProportion" from="0.05" to="0.95" by="0.05" index="0"/>
        <!--gridder spec="likelihoodsurface.Gridder" parameter="@origin" from="{_origin_min}" to="{_origin_max}" by="{_origin_by}"/-->

        <logger fileName="Example3.log" logEvery="1" mode="autodetect" model="@prior" sanitiseHeaders="true" sort="smart">
            <distribution idref='prior' name='log'/>        
            <log idref='R0'/>
            <log idref='becomeUninfectiousRate'/>
            <log idref='samplingProportion'/>            
            <log idref='origin'/>
        </logger>

        <logger id="screenlog" logEvery="1">
            <distribution idref='prior' name='log'/>
            <log idref='R0'/>
            <log idref='becomeUninfectiousRate'/>
            <log idref='samplingProportion'/>            
            <log idref='origin'/>
        </logger>

    </run>

</beast>